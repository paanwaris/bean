% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/test_env_thinning.R
\name{test_env_thinning}
\alias{test_env_thinning}
\title{Perform repeated k-fold cross-validation for a Maxent model}
\usage{
test_env_thinning(
  presence_data,
  background_data,
  env_rasters,
  longitude,
  latitude,
  k = 4,
  n_repeats = 10,
  maxent_args = c("linear=true", "quadratic=false", "product=false", "threshold=false",
    "hinge=false", "doclamp=true")
)
}
\arguments{
\item{presence_data}{A data.frame with at least two columns for longitude and latitude of presence points.}

\item{background_data}{A data.frame with at least two columns for longitude and latitude of background (or pseudo-absence) points.}

\item{env_rasters}{A RasterStack or SpatRaster object of environmental variables.}

\item{longitude}{(character) The name of the longitude column in the data.frames.}

\item{latitude}{(character) The name of the latitude column in the data.frames.}

\item{k}{(numeric) The number of folds for cross-validation. Default = 4.}

\item{n_repeats}{(numeric) The number of times to repeat the k-fold process. Default = 10.}

\item{maxent_args}{(character) A vector of arguments to be passed to the
"dismo::maxent" function. The default enables only linear features. See "?dismo::maxent" for details.}
}
\value{
An object of class \code{bean_evaluation}, which is a list containing:
  \item{summary}{A data.frame with summary statistics (mean, sd, etc.) of the AUC scores.}
  \item{all_auc_scores}{A numeric vector of all AUC scores from every fold and repetition.}
  \item{parameters}{A list of the key parameters used in the evaluation.}
}
\description{
This function provides a metric for evaluating the effect of occurrences thinning in environmental space
using a Maxent model (see Details). Performance is tested using repeated k-fold cross-validation. The test calculates the
Area Under the Curve (AUC) for each fold and repetition, providing a distribution of scores
to assess model stability and predictive accuracy.
}
\details{
This function serves as a wrapper for the \code{dismo::maxent} function, automating
the process of model evaluation through repeated k-fold cross-validation. This
approach provides a robust assessment of a model's predictive performance and
stability, which is particularly useful when comparing models built with
different data inputs (ten Caten et al., 2023).

### Maxent (\code{dismo})

\code{\link{test_env_thinning}} relies on the \code{dismo} package, which provides an R interface to
the standalone Maxent Java application (Hijmans et al., 2024). Maxent is a
presence-background (or presence-only) machine learning algorithm that
estimates a species' potential distribution based on the principle of maximum
entropy (Phillips et al., 2006). It contrasts the environmental conditions at known
presence locations (\code{presence_data}) with the environmental conditions available
across the broader study area, as represented by the \code{background_data}.
The \code{maxent_args} parameter allows for direct control over model complexity, such as specifying different feature
classes (e.g., linear, quadratic, hinge) and adjusting the regularization
multiplier to prevent overfitting (Phillips et al., 2006; Warren and Seifert, 2011).

### Repeated K-Fold Cross-Validation

To provide a rigorous evaluation, this function implements a repeated k-fold cross-validation procedure. The process is as follows:
1. The \code{presence_data} is randomly partitioned into \code{k} equal-sized subsets (folds).
2. The model is trained using \code{k-1} folds and then evaluated on the single held-out fold.
3. This is repeated \code{k} times, with each fold serving as the test set exactly once.
4. The entire k-fold process is then repeated \code{n_repeats} times, each time with a new random partitioning of the data.

### Model Evaluation using AUC

The function calculates the Area Under the Curve (AUC) of the Receiver Operating
Characteristic (ROC) plot for each test fold. AUC is a threshold-independent
metric that measures the model's ability to discriminate between a random
presence site and a random background site (Phillips et al., 2006). An AUC value of 1.0
indicates perfect discrimination, while a value of 0.5 indicates performance
no better than random (Hijmans et al., 2024).
}
\note{
For reproducible results, run "set.seed()" before calling this function.
}
\examples{
\dontrun{
# This is a long-running example and requires the "dismo" package to be installed.

# 1. Load the package's example data
library(raster)
library(dismo)
occ_file <- system.file("extdata", "Peromyscus_maniculatus_prepared.csv", package = "bean")
occ_data <- read.csv(occ_file)

bio1_file <- system.file("extdata", "BIO1.tif", package = "bean")
bio12_file <- system.file("extdata", "BIO12.tif", package = "bean")
env_rasters <- raster::stack(bio1_file, bio12_file)

# 2. Create background points
set.seed(81)
background_pts <- dismo::randomPoints(env_rasters, 1000)
background_df <- as.data.frame(background_pts)
colnames(background_df) <- c("x", "y")

# 3. Run the evaluation with minimal settings for the example
auc_results <- test_env_thinning(
  presence_data = occ_data,
  background_data = background_df,
  env_rasters = env_rasters,
  longitude = "x",
  latitude = "y",
  k = 2,
  n_repeats = 2, # Use a small number for the example
  maxent_args = c("linear=true",
  "quadratic=true",
  "product=false",
  "threshold=false",
  "hinge=false",
  "doclamp=false")
)

# 4. Print the summary and plot the distribution of AUC scores
print(auc_results)
plot(auc_results)
}
}
\references{
Hijmans R, Phillips S, Leathwick J, Elith J (2024). dismo: Species Distribution Modeling. R package version 1.3-16, <https://rspatial.org/raster/sdm/>.

Phillips, S. J., Anderson, R. P., & Schapire, R. E. (2006). Maximum entropy modeling of species geographic distributions. Ecological modelling, 190(3-4), 231-259.

Ten Caten, C., & Dallas, T. (2023). Thinning occurrence points does not improve species distribution model performance. Ecosphere, 14(12), e4703.

Valavi, R., Elith, J., Lahoz-Monfort, J. J., & Guillera-Arroita, G. (2018). blockCV: An r package for generating spatially or environmentally separated folds for k-fold cross-validation of species distribution models. Biorxiv, 357798.

Warren, D. L., & Seifert, S. N. (2011). Ecological niche modeling in Maxent: the importance of model complexity and the performance of model selection criteria. Ecological applications, 21(2), 335-342.
}
