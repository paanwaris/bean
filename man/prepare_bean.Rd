% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prepare_bean.R
\name{prepare_bean}
\alias{prepare_bean}
\title{Prepare data for environmental thinning}
\usage{
prepare_bean(data, env_rasters, longitude, latitude, scale = TRUE)
}
\arguments{
\item{data}{A data.frame of species occurrences records, including columns
for longitude and latitude.}

\item{env_rasters}{A SpatRaster (from \code{terra} package) or RasterStack (from \code{raster} package)
object of environmental variables.}

\item{longitude}{(character) The name of the longitude column in \code{data}.}

\item{latitude}{(character) The name of the latitude column in \code{data}.}

\item{scale}{(logical) If "TRUE" (default), the environmental variables in
\code{env_rasters} will be scaled before extraction. Set to "FALSE" if your
rasters are already on a comparable scale. See Details}
}
\value{
A data.frame containing the cleaned and scaled occurrence data, with
  the following columns:
  \item{Original Columns}{All columns from the input \code{data} are preserved for the valid records.}
  \item{Environmental Variables}{New columns, named after the layers in \code{env_rasters}, containing the extracted and scaled environmental data.}
}
\description{
This function serves as a pre-processing step to clean and prepare species
occurrence data. It performs three key actions:
1. Removes records with missing longitude or latitude values.
2. Extracts environmental data from raster layers that are already scaled
   for each occurrence point.
3. Removes records that fall outside the raster extent or have missing
   environmental data.
The final output is a clean data frame where the environmental variables
have a mean of 0 and a standard deviation of 1.
}
\details{
### The Importance of Scaling Environmental Variables (\code{scale})

Environmental variables used in ecological modeling, such as temperature and
precipitation, often have vastly different units (e.g., °C vs. mm) and
numerical ranges. When using methods based on distance calculations—such as
the Euclidean and Mahalanobis distance these differences in scale can unintentionally bias the analysis. Variables with
larger numerical ranges will dominate the distance metric, while those with
smaller ranges will have a negligible influence (Qiao et al., 2016).

Standardization is the standard procedure to address this issue. By setting
"scale = TRUE", the function transforms each variable to have a mean of 0 and
a standard deviation of 1 (i.e., it calculates z-scores) (Baddeley et al., 2016). This process makes
the variables equal variance. As a result,
each variable contributes equally to the analysis, ensuring that the
resulting resolutions are based on the relative distribution of data points
within each environmental dimension, not their arbitrary original units
(Beaugrand, 2024; Kléparski et al., 2021).
}
\examples{
\dontrun{
library(terra)

# 1. Load sample data
bio1_file <- system.file("extdata", "BIO1.tif", package = "bean")
bio12_file <- system.file("extdata", "BIO12.tif", package = "bean")
env_rasters <- terra::rast(c(bio1_file, bio12_file))

occ_file <- system.file("extdata", "Peromyscus_maniculatus_original.csv", package = "bean")
data <- read.csv(occ_file)

# 2. Run the preparation function
prepared_data <- prepare_bean(
  data = data,
  env_rasters = env_rasters,
  longitude = "x",
  latitude = "y",
  scale = TRUE
)

# 3. View the clean, scaled data
head(prepared_data)
summary(prepared_data)
}
}
\references{
Baddeley, A., Rubak, E. and Turner, R. (2016). Spatial point patterns: methodology and applications with R. CRC press.

Beaugrand, G. (2024). An ecological niche model that considers local relationships among variables: The Environmental String Model. Ecosphere, 15(10), e70015.

Kléparski, L., Beaugrand, G. and Edwards, M. (2021). Plankton biogeography in the North Atlantic Ocean and its adjacent seas: Species assemblages and environmental signatures. Ecology and Evolution, 11(10), 5135-5149.

Qiao, H., Peterson, A. T., Campbell, L. P., Soberón, J., Ji, L. and Escobar, L. E. (2016). NicheA: creating virtual species and ecological niches in multivariate environmental scenarios. Ecography, 39(8), 805-813.
}
